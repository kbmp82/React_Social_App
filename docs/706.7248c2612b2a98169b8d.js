"use strict";(self.webpackChunkreact_social_app=self.webpackChunkreact_social_app||[]).push([[706],{706:(e,a,t)=>{t.r(a),t.d(a,{default:()=>u});var s=t(294),r=t(983),c=t(564),l=t(625),n=t(655),m=t(177);function u(){const e=(0,s.useRef)(null),a=(0,s.useContext)(r.Z),t=(0,s.useContext)(c.Z),u=(0,s.useRef)(null),i=(0,s.useRef)(null),[o,p]=(0,l.x)({inputValue:"",messages:[]});return(0,s.useEffect)((()=>{t.isChatOpen&&(u.current.focus(),a({type:"clearUnreadChatCount"}))}),[t.isChatOpen]),(0,s.useEffect)((()=>(e.current=(0,m.ZP)("http://localhost:8080"),e.current.on("chatFromServer",(e=>{p((a=>{a.messages.push(e)}))})),()=>e.current.disconnect())),[]),(0,s.useEffect)((()=>{i.current.scrollTop=i.current.scrollHeight,o.messages.length&&!t.isChatOpen&&a({type:"incrementUnreadChatCount"})}),[o.messages]),s.createElement("div",{id:"chat-wrapper",className:"chat-wrapper shadow border-top border-left border-right"+(t.isChatOpen&&" chat-wrapper--is-visible")},s.createElement("div",{className:"chat-title-bar bg-primary"},"Chat",s.createElement("span",{onClick:()=>a({type:"triggerChat",value:!1}),className:"chat-title-bar-close"},s.createElement("i",{className:"fas fa-times-circle"}))),s.createElement("div",{ref:i,id:"chat",className:"chat-log"},o.messages.map(((e,a)=>e.username==t.user.username?s.createElement("div",{key:a,className:"chat-self"},s.createElement("div",{className:"chat-message"},s.createElement("div",{className:"chat-message-inner"},e.message)),s.createElement("img",{alt:"avatar",className:"chat-avatar avatar-tiny",src:e.avatar})):s.createElement("div",{key:a,className:"chat-other"},s.createElement(n.rU,{to:`/profile/${e.username}`},s.createElement("img",{alt:"avatar",className:"avatar-tiny",src:e.avatar})),s.createElement("div",{className:"chat-message"},s.createElement("div",{className:"chat-message-inner"},s.createElement(n.rU,{to:`/profile/${e.username}`},s.createElement("strong",null,e.username,":"))," ",e.message)))))),s.createElement("form",{onSubmit:function(a){a.preventDefault(),o.inputValue.trim()&&(e.current.emit("chatFromBrowser",{message:o.inputValue,token:t.user.token}),p((e=>{e.messages.push({message:e.inputValue,username:t.user.username,avatar:t.user.avatar}),e.inputValue=""})))},id:"chatForm",className:"chat-form border-top"},s.createElement("input",{ref:u,onChange:function(e){const a=e.target.value;p((e=>{e.inputValue=a}))},value:o.inputValue,type:"text",className:"chat-field",id:"chatField",placeholder:"Type a messageâ€¦",autoComplete:"off","aria-label":"chat field"})))}}}]);